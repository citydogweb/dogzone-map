<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">
<link rel="import" href="../google-map/google-map.html">

<!--
An element providing a solution to no problem in particular.

Example:

    <dogzone-map></dogzone-map>

@demo
-->
<dom-module id="dogzone-map">

  <style>
  :host {
    position: relative;
    display: block;
    height: 100%;
  }
  #map {
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
  </style>

  <template>

    <iron-ajax auto url="http://data.wien.gv.at/daten/geo/" params='{"service":"WFS", "request":"getFeature", "version":"1.1.0", "typeName":"ogdwien:HUNDEZONEOGD", "srsName":"EPSG:4326", "outputFormat":"json"}'
    handleAs="json" on-response="handleParks" on-error="handleParkError"></iron-ajax>

    <google-map id="map" fit-to-markers on-google-map-click="handleClick" click-events>
      <template is="dom-repeat" items="{{coords.features}}" as="coord">
        <google-map-marker latitude="{{coord.geometry.coordinates.1}}" longitude="{{coord.geometry.coordinates.0}}" title="{{coords.features.proprties.PARK}}" icon="../dog_map_icon.png">
          <div style="margin-left: 16px; margin-bottom: 16px;">
  	         <p>Hier steht Text</p>
          </div>
        </google-map-marker>
      </template>
    </google-map>

  </template>

</dom-module>

<script>

  Polymer({
    is: 'dogzone-map',

    ready: function() {
    },

    handleParks: function(event, response) {
      this.coords = response.response;

    //  console.log(this.coords);
    //  console.log(this.$.map);

    },

    handleParkError: function(event, error) {
      console.log("ERROR");
      console.log(error);
    },

    handleClick: function(event) {
      this.$.map.resize();
    }
  });

</script>
